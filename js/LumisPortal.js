var LumisPortal=new LumisPortal;function LumisPortal(){var arrHtmlProcessorCallbacks=[];if(this.HtmlProcessor={register:function(e){arrHtmlProcessorCallbacks.push(e)},process:function(e){void 0===e&&(e=document.documentElement);for(var t=0;t<arrHtmlProcessorCallbacks.length;t++)try{arrHtmlProcessorCallbacks[t](e)}catch(e){window.console&&window.console.error&&window.console.error(e)}}},this.onKeyDown=onKeyDown,this.onRefresh=onRefresh,this.onSubmitForm=onSubmitForm,this.onPrint=onPrint,this.getCookie=getCookie,this.addMessage=addMessage,this.onBodyLoad=onBodyLoad,this.checkForMessages=checkForMessages,this.gotoPage=gotoPage,this.htmlEncode=htmlEncode,this.mainName="main.jsp",this.pageParameterChannelIdName="lumChannelId",this.pageParameterPageIdName="lumPageId",this.isSubmitting=!1,this.renderInterfaceInstance=renderInterfaceInstance,this.renderInterfaceInstance_internal=renderInterfaceInstance_internal,this.getXmlHttpObject=getXmlHttpObject,this.lumisEncodeURIComponent=lumisEncodeURIComponent,this.bindReady=bindReady,this.switchAutoAdministrationChannel=switchAutoAdministrationChannel,this.closeInterfaceInstance=closeInterfaceInstance,this.opener=getOpenerWindow(),this.xmlEncode=xmlEncode,this.xmlDecode=xmlDecode,bindReady(onBodyLoad,LumisPortal),bindReady(this.HtmlProcessor.process),window.addEventListener)try{window.addEventListener("pageshow",onPageShow,!1)}catch(e){}function bindReady(e,t){function n(){i||(document.body?(i=!0,e.call(t)):setTimeout(arguments.callee,10))}var o,i=!1;document.addEventListener?document.addEventListener("DOMContentLoaded",function(){if(window.opera)for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].disabled)return void setTimeout(arguments.callee,10);n()},!1):/msie/i.test(navigator.userAgent)?function(){try{document.documentElement.doScroll("left")}catch(e){return setTimeout(arguments.callee,10)}n()}():/webkit/i.test(navigator.userAgent)?function(){!1===/loaded|complete/i.test(document.readyState)?setTimeout(arguments.callee,10):n()}():(o=window.onload,window.onload=function(){o&&"function"==typeof window.onload&&o(),n()})}function onPageShow(){this.isSubmitting=!1}function gotoPage(e,t){var n=document.forms.LumisPortalForm.action,n=n.substring(0,n.indexOf("main.jsp")+8);null!=e&&(n+="?"+this.pageParameterPageIdName+"="+e),null!=t&&(n=n+(null==e?"?":"&")+this.pageParameterChannelIdName+"="+t),window.location.href=n}function onKeyDown(event){var xmlHttp,responseText,toggleModeUrlServer;this.isSubmitting||(event=event||window.event,event&&113==event.keyCode&&(xmlHttp=getXmlHttpObject(),responseText=null,toggleModeUrlServer=g_LumisRootPath+"lumis/api/rest/lum-internal/admin/mode/gettogglemodeurl?lumCurrentDisplayModeId="+g_LumisDisplayMode+"&lumReferer="+LumisPortal.lumisEncodeURIComponent(document.location.href)+"&lumPageId="+g_LumisPageId+"&lumChannelId="+g_LumisChannelId,xmlHttp.open("POST",toggleModeUrlServer,!0),xmlHttp.onreadystatechange=function(){if(4==xmlHttp.readyState&&200==xmlHttp.status){var json=eval("("+xmlHttp.responseText+")");if(json&&json.toggleModeUrl){try{event.ctrlKey&&(document.forms.LumisPortalForm.elements.lumSafeRenderMode.value="1")}catch(e){}"true"===json.formRedirect?(document.forms.LumisPortalForm.action=json.toggleModeUrl,document.forms.LumisPortalForm.submit(),this.isSubmitting=!0):window.location.replace(json.toggleModeUrl)}}},xmlHttp.send()))}function switchAutoAdministrationChannel(e){document.forms.LumisPortalForm.action=e,document.forms.LumisPortalForm.submit(),this.isSubmitting=!0}function onRefresh(){this.isSubmitting||(g_LumisIsHtmlCache?(this.isSubmitting=!0,document.location.reload()):(document.forms.LumisPortalForm.submit(),this.isSubmitting=!0))}function onPrint(e){this.isSubmitting||(e?(e=document.forms.LumisPortalForm.target,document.forms.LumisPortalForm.target="_blank",document.forms.LumisPortalForm.elements.lumPrinting.value="1",document.forms.LumisPortalForm.submit(),document.forms.LumisPortalForm.target=e,document.forms.LumisPortalForm.elements.lumPrinting.value="0"):(document.forms.LumisPortalForm.elements.lumPrinting.value="1",document.forms.LumisPortalForm.submit(),this.isSubmitting=!0))}function onSubmitForm(e,t,n,o,i,l){if(!this.isSubmitting){var r=document.forms[e],s=document.forms.LumisPortalForm;if(r.action.match(/[&?]doui_editingVersion=1(&|$)/)&&createInputHidden(s,"doui_editingVersion","1"),!formHasFileInputs(r)&&!isFormWSRPAction(r)||null!=l){var a='<parameters destId="'+t+'" destType="'+(n=null==n?"lumII":n)+'">',e=(a+=getFormParameters(e),s.elements.lumNewParams.value=a+="</parameters>",s.action);if(null!=t&&null!=(a=s.elements[n])&&(a.value=t),null!=i&&(s.action+="#"+i),o)s.elements.lumA.value="1";else if(r&&r.action){r.action;if(null!=l){n=document.getElementById(l);if(n)return renderInterfaceInstance(n,t,!0),s.elements.lumNewParams.value="",void(s.action=e)}else{a=r.elements.lumClientRendered;if(null!=a&&1==a.value){i=getInterfaceInstanceDiv(t);if(i)return renderInterfaceInstance(i,t),s.elements.lumNewParams.value="",void(s.action=e)}}}this.isSubmitting=!0,s.submit()}else try{copyFormElements(s,r),o&&null!=r.elements.lumA&&(r.elements.lumA.value="1"),this.isSubmitting=!0,r.submit()}catch(e){lumis_doui_control_fileupload_FileUploadControl_msgFileNotFound?alert(lumis_doui_control_fileupload_FileUploadControl_msgFileNotFound):alert(e.message),this.isSubmitting=!1}}}function getInterfaceInstanceDiv(e){for(var t=document.getElementsByTagName("*"),n=0;n<t.length;n++)if(t[n].replacedByII&&e==t[n].replacedByII)return t[n];return document.getElementById("lumIId"+e)}function copyFormElements(e,t){null==t.elements.lumFromForm&&createInputHidden(t,"lumFromForm",t.name);for(var n=0;n<e.elements.length;n++){var o=e.elements[n];if(o.type&&o.name&&o.name.length&&"lumA"!=o.name)if("button"!=o.type&&"submit"!=o.type)if("select-one"==o.type&&-1!=o.selectedIndex)(i=o.options[o.selectedIndex].value).length&&createInputHidden(t,o.name,i);else if("select-multiple"==o.type)for(var i="",l=0;l<o.options.length;l++){var i=o.options[l].value;o.options[l].selected&&i.length&&createInputHidden(t,o.name,i)}else("checkbox"!=o.type&&"radio"!=o.type||o.checked)&&void 0!==(i=o.value)&&i.length&&createInputHidden(t,o.name,i)}}function createInputHidden(e,t,n){var o=window.document.createElement("input");o.type="hidden",o.name=t,o.value=n,e.appendChild(o)}function formHasFileInputs(e){for(var t=0;t<e.elements.length;t++)if("file"==(pElement=e.elements[t]).type)return 1}function isFormWSRPAction(e){return e.action&&-1!=e.action.indexOf("&lwsUT=")}function getFormParameters(e){var t="",n=document.forms[e],e=(t+='<p n="lumFromForm">'+htmlEncode(e)+"</p>",n.action);e&&e.length&&(t+='<p n="lumFormAction">'+htmlEncode(e)+"</p>");for(var o=0;o<n.elements.length;o++){var i=n.elements[o];if(i.type&&i.name&&i.name.length)if("button"!=i.type&&"submit"!=i.type)if("select-one"==i.type&&-1!=i.selectedIndex)(l=i.options[i.selectedIndex].value).length&&(t+='<p n="'+i.name+'">'+htmlEncode(l)+"</p>");else if("select-multiple"==i.type)for(var l="",r=0;r<i.options.length;r++){var l=i.options[r].value;i.options[r].selected&&l.length&&(t+='<p n="'+i.name+'">'+htmlEncode(l)+"</p>")}else("checkbox"!=i.type&&"radio"!=i.type||i.checked)&&(l=i.value)&&l.length&&(t+='<p n="'+i.name+'">'+htmlEncode(l)+"</p>")}return t}function xmlDecode(e){return e=(e=(e=(e=(e=e.replace(/\&lt;/g,"<")).replace(/\&gt;/g,">")).replace(/\&apos;/g,"'")).replace(/\&quot;/g,'"')).replace(/\&amp;/g,"&")}function xmlEncode(e){return e=(e=(e=(e=(e=e.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/\'/g,"&apos;")).replace(/\"/g,"&quot;")}function getCookie(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var o=t[n].split("=");if(e==o[0])return o=(o=o[1]).replace(/\+/g," "),(decodeURIComponent||unescape)(o)}return null}function setCookie(e,t,n){var o,t=lumisEncodeURIComponent(t);n?((o=new Date).setTime(o.getTime()+24*n*60*60*1e3),document.cookie=e+"="+t+"; expires="+o.toGMTString()+"; "):document.cookie=e+"="+t+"; "}function removeCookie(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var o=t[n].split("=");if(e==o[0])return o=o[1],setCookie(e,"",-1),o=o.replace(/\+/g," "),(decodeURIComponent||unescape)(o)}}function addMessage(e){var t=document.forms.LumisPortalForm.elements.lumClientMessage;""!=t.value&&(t.value+="\n"),t.value+=e}function onBodyLoad(){var e=document.forms.LumisPortalForm;e&&(e.elements.lumNewParams.value="",e.elements.lumA.value="",checkForMessages())}function checkForMessages(){""!=document.forms.LumisPortalForm.elements.lumClientMessage.value&&window.setTimeout(showMessages,1)}function showMessages(){var e=document.forms.LumisPortalForm.elements.lumClientMessage.value;""!=e&&(alert(e),document.forms.LumisPortalForm.elements.lumClientMessage.value="")}function htmlEncode(e){return e=(e=(e=(e=(e=(e="string"!=typeof e?e.toString():e).replace(/&/g,"&amp;")).replace(/"/g,"&quot;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&#39;")}var htmlSer=function(){var e=document.createElement("div");return e.style.display="none",e.innerHTML="   <link/>",!!e.getElementsByTagName("link").length}();function renderInterfaceInstance(e,t,n){renderInterfaceInstance_internal(e,t,n)}function renderInterfaceInstance_internal(t,e,n,o,i,l,r){1!=n&&0<t.innerHTML.length?((u=document.createElement("div")).style.position="absolute",u.style.width=t.offsetWidth+"px",u.style.height=t.offsetHeight+"px",u.style.overflow="hidden",u.style.zIndex="1001",u.className="cLumClientRenderWaitBox",(s=document.createElement("div")).style.position="absolute",s.style.width=t.offsetWidth+"px",s.style.height=t.offsetHeight+"px",s.style.overflow="hidden",s.style.zIndex="1002",s.style.textAlign="center",s.style.paddingTop="5px",s.innerHTML=g_LumisLoadingHtmlMessage,0<t.childNodes.length?t.insertBefore(u,t.childNodes[0]):t.appendChild(u),t.insertBefore(s,t.childNodes[0])):1!=n&&(t.innerHTML=g_LumisLoadingHtmlMessage);var s,a=getXmlHttpObject();var m="lumPrevParams="+lumisEncodeURIComponent(document.forms.LumisPortalForm.elements.lumPrevParams.value),u=document.forms.LumisPortalForm.elements.lumNewParams.value;if(LumisParametersController.add(u),m=(m+="&lumNewParams="+lumisEncodeURIComponent(u))+("&lumReplIntfState="+lumisEncodeURIComponent(document.getElementsByName("lumReplIntfState")[0].value)),void 0!==i&&(m+="&lumStyleToApply="+lumisEncodeURIComponent(i)),void 0!==o&&(m+="&lumStyleToApplyId="+lumisEncodeURIComponent(o)),void 0!==r&&(m+="&lumXslToApplyToken="+lumisEncodeURIComponent(r)),void 0===l&&(l=document.location.href),window.LumisBWKeys)for(key in window.LumisBWKeys)m+="&lumWriterKeys="+lumisEncodeURIComponent(key);a.open("POST",document.forms.LumisPortalRenderInterfaceForm.action+"&lumScript=1&lumRenderII="+e+"&lumReferer="+lumisEncodeURIComponent(l),!0),a.onreadystatechange=function(){if(a&&4==a.readyState){for(var n=t,e=a.responseText;n.firstChild;)n.removeChild(n.firstChild);function o(e,t,n){var o,i=e.ownerDocument||document,l=i.head||i.getElementsByTagName("head")[0],r=i.createDocumentFragment(),s=[],a=r,m=s,u=[];t&&(i=i.createElement("div"),htmlSer?i.innerHTML=t:(i.innerHTML="div<div>"+t+"</div>",i=i.lastChild),(t=i.childNodes).nodeType?u.push(t):u=c(u,t));for(var d=0;u[d];d++)!m||"script"!==(u[d].tagName||"").toLowerCase()||u[d].type&&"text/javascript"!==u[d].type.toLowerCase()?(1===u[d].nodeType&&(o=c([],u[d].getElementsByTagName("script")),u.splice.apply(u,[d+1,0].concat(o))),a.appendChild(u[d])):m.push(u[d].parentNode?u[d].parentNode.removeChild(u[d]):u[d]);function c(e,t){for(var n=e.length,o=0;o<t.length;o++)e[n++]=t[o];return e.length=n,e}if((1===r.childNodes.length?r=r.firstChild:r.firstChild)&&(n?"HEAD_START"===n?l.insertBefore(r,l.firstChild):"HEAD_END"===n?l.appendChild(r):"BODY"===n&&e.appendChild(r):e.appendChild(r)),s.length){for(var p="",f=0;s[f];f++){var g=function(e){{var t;return e.src?(t=getXmlHttpObject(),t.open("GET",e.src,!1),t.send(),t.responseText):e.text||e.textContent||e.innerHTML}}(s[f]);g&&(p+=g+";")}(i=p)&&(window.execScript||function(e){window.eval.call(window,e)})(i)}}LumisPortal.tempRenderHtml=function(e,t){o(n,e,t)},o(n,e),LumisPortal.tempRenderHtml=void 0,LumisPortal.HtmlProcessor.process(n),a=null}},a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(m)}function getXmlHttpObject(){return window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}function lumisEncodeURIComponent(e){return(encodeURIComponent||escape)(e)}function closeInterfaceInstance(e,t){if(e){null==t&&(t="Form_"+e);var n=document.getElementsByName("lumReplIntfState")[0].value;if(null!=n&&-1!=n.indexOf(e))return void onSubmitForm(t,e,null,!(document.forms[t].elements.lumReplIntfCommands.value="r"))}window.self!=window.top&&(window.parent.LumisLightBoxAdmin||window.parent.LumisLightBox)?!window.parent.LumisLightBoxAdmin||window.parent.LumisLightBoxAdmin.isOpen&&!window.parent.LumisLightBoxAdmin.isOpen()?!window.parent.LumisLightBox||window.parent.LumisLightBox.isOpen&&!window.parent.LumisLightBox.isOpen()||window.parent.LumisLightBox.close():window.parent.LumisLightBoxAdmin.close():window.close()}function getOpenerWindow(){return"undefined"!=typeof $_lumDoNotCalculateWindowOpener?null:window.opener||(window.self!=window.top&&window.parent?window.parent:null)}this.removeReplaces=function(e){for(var t=document.getElementsByName("lumReplIntfState")[0].value,n="",o=e.join(","),i=t.split(";"),l=0;l<i.length;l++){var r=i[l].split("="),s=r[0],r=r[1];-1==o.search(s)&&(0<n.length&&(n+=";"),n+=s+"="+r)}document.getElementsByName("lumReplIntfState")[0].value=n},this.addReplaces=function(e){var t,n=document.getElementsByName("lumReplIntfState")[0].value;for(t in e)0<n.length&&(n+=";"),n+=t+"="+e[t];document.getElementsByName("lumReplIntfState")[0].value=n};var LumisParametersController=function(){var e,o=[],i={waitingResponse:!1,running:!1,process:function(){var e;0==o.length?i.stop():i.waitingResponse?i.schedule(50):(e=o[0],i.makeRequest(e),0<o.length&&i.schedule(10))},start:function(){this.running=!0,this.schedule(10)},stop:function(){this.running=!1},schedule:function(e){window.setTimeout(this.process,e)},add:function(e){o.push(e),this.running||this.start()},makeRequest:function(e){var t="lumPrevParams="+l().value,n=(t+="&lumNewParams="+lumisEncodeURIComponent(e),getXmlHttpObject());n.open("POST",g_LumisRootPath+"lumis/portal/controller/html/PortalRequestParametersControllerHtml.jsp",!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.waitingResponse=!0,n.onreadystatechange=function(){var e;n&&4==n.readyState&&(200!=n.status?(window.console.error||window.console.info||window.console.log||window.console.debug)("HTTP error "+n.status+" on request to PortalRequestParametersControllerHtml.jsp"):(e=n.responseText,e=lumisEncodeURIComponent(e),l().value=e,o=function(){for(var e=[],t=1;t<o.length;t++)e.push(o[t]);return e}(),n=null,i.waitingResponse=!1))},n.send(t)}};function l(){return e=e||document.forms.LumisPortalForm.elements.lumPrevParams}return{add:function(e){i.add(e)}}}();this.executeReplaceInterfaceCommands=function(e,t,n,o){e.elements.lumReplIntfCommands.value=n,o&&(e.elements.lumReplIntfParams.value=o),onSubmitForm(e.id||e.name,t,null,!1)},this.initLumisPortalForm=function(e){function t(e){return decodeURIComponent(e.replace(/\\+/g,"%20"))}var n=location.href.indexOf("?");if(-1!==n){for(var o=window.location.href.substring(n+1),n=o.indexOf("#"),i=(o=-1!==n?o.substring(0,n):o).split("&"),l="",r=0;r<i.length;r++){var s=o.split("=");2===s.length&&(l+='<p n="'+LumisPortal.xmlEncode(t(s[0]))+'">'+LumisPortal.xmlEncode(t(s[1]))+"</p>")}0!==l.length&&-1!==(n=e.lastIndexOf("</allParameters>"))&&(e=(e=e.substring(0,n))+"<parameters>"+l+"</parameters></allParameters>")}document.forms.LumisPortalForm.elements.lumPrevParams.value=encodeURIComponent(e)}}document.onkeydown=LumisPortal.onKeyDown;